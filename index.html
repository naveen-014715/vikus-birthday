<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Birthday Envelope</title>
<style>
:root{
  --env-w: 85vw;
  --env-h: calc(var(--env-w) * 0.65);
  --env-fill: #f8a5c2;
  --env-stroke: #e75480;
}

/* ------------------- BASE STYLES ------------------- */
html,body{
  height:100%;
  margin:0;
  font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: linear-gradient(135deg, #fff3f9 0%, #ffc0cb 100%);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow: hidden;
  position: relative;
}
.stage{
  width: var(--env-w);
  height: 420px;
  position: relative;
  user-select: none;
  z-index: 10;
}

/* ------------------- DECORATIONS ------------------- */
.decorations {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}
.balloon, .floating-heart, .confetti, .flower, .cake {
  position: absolute;
  opacity: 0;
  transform: translateY(100vh) scale(0.5);
}

/* Balloon shape */
.balloon {
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  background: linear-gradient(135deg, #ff6699, #ff3366);
}
.balloon::after {
  content:'';
  position: absolute;
  bottom: -15px;
  left: 50%;
  width: 2px;
  height: 20px;
  background: #aa4466;
  transform: translateX(-50%);
  border-radius: 0 0 50% 50%;
}

/* Floating heart shape */
.floating-heart {
  background: #ff6699;
  transform: translateY(100vh) rotate(-45deg);
}
.floating-heart::before, .floating-heart::after {
  content:"";
  position:absolute;
  background:#ff6699;
  border-radius:50%;
}
.floating-heart::before { top:-50%; left:0; width:100%; height:100%; }
.floating-heart::after { left:50%; top:0; width:100%; height:100%; }

/* Confetti */
.confetti { width:6px; height:6px; background:#ffd700; border-radius:2px; }

/* Flowers */
.flower { width:8px; height:8px; background:#ff66cc; border-radius:50%; }

/* Cakes */
.cake { width:10px; height:10px; background:#ff9966; border-radius:3px; }

/* Keyframes for floating animation */
@keyframes floatUp {
  0% { transform: translateY(100vh) translateX(0) scale(0.5); opacity:0; }
  20% { opacity:0.8; }
  50% { transform: translateY(50vh) translateX(15px) scale(0.7); }
  80% { opacity:0.8; }
  100% { transform: translateY(-10vh) translateX(-15px) scale(0.5); opacity:0; }
}

/* ------------------- BURST HEART ------------------- */
.burst-heart {
  position: fixed;
  width: 15px;
  height: 15px;
  background: #e60033;
  transform: rotate(-45deg);
  pointer-events: none;
  z-index: 1000;
}
.burst-heart::before, .burst-heart::after {
  content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  background: #e60033;
  border-radius: 50%;
}
.burst-heart::before { top:-50%; left:0; }
.burst-heart::after { left:50%; top:0; }

/* ------------------- ENVELOPE ------------------- */
.envelope {
  width: var(--env-w);
  height: var(--env-h);
  margin: 0 auto;
  position: absolute;
  top: 80px;
  left: 0;
  right: 0;
  cursor: pointer;
  overflow: visible;
  -webkit-tap-highlight-color: transparent;
}
.env-svg {
  width: 100%;
  height: 100%;
  display:block;
}
.env-shadow {
  filter: drop-shadow(0 10px 18px rgba(0,0,0,0.18));
}
/* Heart on envelope */
.heart {
  position: absolute;
  top:50%;
  left:50%;
  transform: translate(-50%,-50%) rotate(-45deg);
  width:12vw;
  height:12vw;
  background:#e60033;
  z-index:6;
  transition: transform .18s ease, box-shadow .18s ease;
}
.heart::before,.heart::after{
  content:"";
  position:absolute;
  width:100%;
  height:100%;
  background:#e60033;
  border-radius:50%;
}
.heart::before{ top:-50%; left:0; }
.heart::after{ left:50%; top:0; }
.heart:hover{ transform: translate(-50%,-50%) rotate(-45deg) scale(1.08); box-shadow:0 8px 18px rgba(230,0,80,0.18); }

/* Letter */
.letter {
  position: absolute;
  left:50%;
  width:90vw;
  transform: translateX(-50%);
  top:240px;
  background:#fffdf5;
  border-radius:10px;
  padding:4vw;
  box-shadow:0 10px 24px rgba(0,0,0,0.14);
  border:1px solid rgba(0,0,0,0.06);
  opacity:0;
  transition: top 700ms cubic-bezier(.2,.9,.25,1), opacity 400ms ease, transform 700ms cubic-bezier(.2,.9,.25,1);
  z-index:20;
  pointer-events:none;
}
.stage.open .letter{
  top:10px;
  opacity:1;
  pointer-events:auto;
}
.letter h2{ margin:0 0 10px 0; color:#d81b60; font-size:5vw; }
.letter p{ margin:0; color:#333; line-height:1.6; font-size:4vw; }

</style>
</head>
<body>

<div class="decorations" id="decorations"></div>

<div class="stage" id="stage">
  <div class="envelope" id="envelope" aria-hidden="false" title="Open">
    <svg class="env-svg env-shadow" viewBox="0 0 340 220" xmlns="http://www.w3.org/2000/svg">
      <rect x="6" y="6" rx="8" ry="8" width="328" height="208" fill="#f8a5c2" stroke="#e75480" stroke-width="4"/>
      <line x1="6" y1="6"   x2="170" y2="110" stroke="#e75480" stroke-width="3" stroke-linecap="round" />
      <line x1="334" y1="6" x2="170" y2="110" stroke="#e75480" stroke-width="3" stroke-linecap="round" />
      <line x1="6" y1="214" x2="170" y2="110" stroke="#e75480" stroke-width="3" stroke-linecap="round" />
      <line x1="334" y1="214" x2="170" y2="110" stroke="#e75480" stroke-width="3" stroke-linecap="round" />
    </svg>
    <div class="heart" id="heart" aria-hidden="false" role="button" title="Open letter"></div>
  </div>

  <div class="letter" id="letter">
    <h2>Happy Birthday, My Love üéâ</h2>
    <p>
      Wishing you the happiest birthday, my darling! üíï<br><br>
      Even though we‚Äôre far apart today, my heart is right there with you.
      I‚Äôm counting down to all the new memories we‚Äôll make together.
      You mean the world to me ‚Äî forever and always.
      <br><br>
      With all my love,<br>‚ù§Ô∏è Yours forever
    </p>
  </div>
</div>

<script>
const stage = document.getElementById('stage');
const heart = document.getElementById('heart');
const envelope = document.getElementById('envelope');
const decorations = document.getElementById('decorations');
const audio = new Audio('path/to/your/pop_sound.mp3');

// --- Generate decorations dynamically ---
const decoTypes = ['balloon','floating-heart','confetti','flower','cake'];
const decoCount = { 'balloon':20, 'floating-heart':20, 'confetti':30, 'flower':15, 'cake':10 };

decoTypes.forEach(type=>{
  for(let i=0;i<decoCount[type];i++){
    const el = document.createElement('div');
    el.className=type;
    const size = 10 + Math.random()*20;
    el.style.width = el.style.height = size+'px';
    el.style.left = Math.random()*90+'%';
    el.style.animation = `floatUp ${6+Math.random()*6}s linear ${Math.random()*10}s infinite`;
    decorations.appendChild(el);
  }
});

// --- Heart Burst ---
function createHeartBurst(centerElement){
  const rect = centerElement.getBoundingClientRect();
  const centerX = rect.left + rect.width/2;
  const centerY = rect.top + rect.height/2;
  const numberOfHearts = 50;
  const maxDistance = Math.min(window.innerWidth, window.innerHeight)/2;

  for(let i=0;i<numberOfHearts;i++){
    const burstHeart = document.createElement('div');
    burstHeart.className='burst-heart';
    const scale = 0.8 + Math.random()*1.5;
    burstHeart.style.width = burstHeart.style.height = 15*scale+'px';
    burstHeart.style.left = centerX+'px';
    burstHeart.style.top = centerY+'px';

    const angle = Math.random()*2*Math.PI;
    const distance = 50 + Math.random()*maxDistance;
    const travelX = distance*Math.cos(angle);
    const travelY = distance*Math.sin(angle);

    document.body.appendChild(burstHeart);
    burstHeart.animate([
      { transform:`translate(-50%,-50%) rotate(-45deg) scale(1)`, opacity:1 },
      { transform:`translate(calc(-50% + ${travelX}px), calc(-50% + ${travelY}px)) rotate(45deg) scale(0.5)`, opacity:0 }
    ], { duration: 800+Math.random()*400, easing:'ease-out', fill:'forwards' })
    .onfinish = ()=>burstHeart.remove();
  }
}

// --- Envelope Open ---
function toggleOpen(e){
  e.stopPropagation();
  if(!stage.classList.contains('open')){
    audio.currentTime=0; audio.play().catch(()=>{});
    createHeartBurst(heart);
  }
  stage.classList.toggle('open');
  heart.animate([{ transform: heart.style.transform+' scale(1.04)'},{ transform: heart.style.transform+' scale(1)'}],{duration:200,easing:'ease-out'});
}
heart.addEventListener('click',toggleOpen);
envelope.addEventListener('click',toggleOpen);
document.body.addEventListener('click',(ev)=>{
  if(!stage.contains(ev.target)) stage.classList.remove('open');
});
</script>
</body>
</html>
